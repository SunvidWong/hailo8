# Mosquitto MQTT Broker 配置
# 为Frigate和Hailo8提供消息通信服务

# 基本配置
pid_file /var/run/mosquitto.pid
persistence true
persistence_location /mosquitto/data/
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout

# 网络配置
port 1883
listener 9001
protocol websockets

# 最大连接数
max_connections 1000
max_inflight_messages 100
max_queued_messages 1000

# 日志级别
log_type error
log_type warning
log_type notice
log_type information
log_timestamp true

# 连接限制
max_client_connections -1

# 保持连接时间
keepalive_interval 60

# QoS配置
max_qos 2

# 队列配置
queue_qos0_messages 1000

# 消息大小限制
message_size_limit 268435455

# 安全配置
allow_anonymous false
password_file /mosquitto/config/passwd

# 访问控制列表
acl_file /mosquitto/config/acl

# 自动保存间隔
autosave_interval 1800

# 系统时间戳
sys_interval 10

# 连接消息
connection_messages true

# 日志时间戳格式
log_timestamp_format %Y-%m-%dT%H:%M:%S

# 自动重新加载配置
reload_config true

# 状态发布
# 每30秒发布MQTT服务器状态
# 这对于监控MQTT服务器状态很有用